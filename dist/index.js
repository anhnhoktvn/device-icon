function t(t){const e=new Image;return new Promise(n=>{e.onload=(()=>n(e)),e.src=t})}const e=document.createElement("canvas");e.width=60,e.height=20;const n=e.getContext("2d");n.imageSmoothingEnabled=!0;const r={};const a=document.createElement("canvas"),i=a.getContext("2d");function o(e,n,{IMAGES:r,ICON_SIZE:o,IMG_W:c,IMG_H:h}){return new Promise(function(u,l){let d,g,s;return function(e,n){const r=n[e];return r||console.error("no image status",e),t(r)}(e,r).then(function(e){try{return d=e,a.width=o,a.height=o,i.clearRect(0,0,a.width,a.height),i.save(),i.translate(a.width/2,a.height/2),i.rotate(n*Math.PI/180),i.drawImage(d,0,0,d.naturalWidth,d.naturalHeight,-c/2,-h/2,c,h),i.restore(),t(g=a.toDataURL()).then(function(t){try{return u(s=t)}catch(t){return l(t)}},l)}catch(t){return l(t)}},l)})}i.imageSmoothingEnabled=!0;const c=52,h=c,u=Math.round(.4*c),l=c+u,d=c/2,g=document.createElement("canvas");g.width=h,g.height=l;const s=g.getContext("2d");s.imageSmoothingEnabled=!0;const m={};module.exports=function(a,i,w,f){return new Promise(function(x,I){let y,E,S,M;return i=Math.round(i||0)%360,m[y=`${a}|${i}|${w}`]?x(m[y]):o(a,i,f).then(function(a){try{return E=a,s.clearRect(0,0,g.width,g.height),s.drawImage(E,0,0,E.naturalWidth,E.naturalHeight,0,0,c,c),function(a){return new Promise(function(i,o){let c,h;return r[a]?i(r[a]):(n.fillStyle="white",n.fillRect(0,0,e.width,e.height),n.textAlign="center",n.textBaseline="top",n.fillStyle="black",n.font="bold 18px Arial",n.fillText(a,e.width/2,0,e.width),t(c=e.toDataURL()).then(function(t){try{return r[a]=h=t,i(h)}catch(t){return o(t)}},o))})}(w).then(function(t){try{return s.drawImage(S=t,0,0,S.naturalWidth,S.naturalHeight,0,l-u,g.width,u),M={url:g.toDataURL(),origin:{x:0,y:0},anchor:{x:d,y:d},scaledSize:{width:h,height:l}},m[y]=M,x(M)}catch(t){return I(t)}},I)}catch(t){return I(t)}},I)})};
//# sourceMappingURL=index.js.map
